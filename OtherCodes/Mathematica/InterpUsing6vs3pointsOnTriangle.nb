(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10463,        311]
NotebookOptionsPosition[      9761,        292]
NotebookOutlinePosition[     10094,        307]
CellTagsIndexPosition[     10051,        304]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N6i", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", "-", 
       RowBox[{"3", "\[Epsilon]"}], "-", 
       RowBox[{"3", "\[Eta]"}], "+", 
       RowBox[{"2", 
        RowBox[{"\[Epsilon]", "^", "2"}]}], "+", 
       RowBox[{"2", 
        RowBox[{"\[Eta]", "^", "2"}]}], "+", 
       RowBox[{"4", "\[Epsilon]", "*", "\[Eta]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"\[Epsilon]", "^", "2"}]}], "-", "\[Epsilon]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"\[Eta]", "^", "2"}]}], "-", "\[Eta]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4", "\[Epsilon]"}], "-", 
       RowBox[{"4", 
        RowBox[{"\[Epsilon]", "^", "2"}]}], "-", 
       RowBox[{"4", "\[Epsilon]", "*", "\[Eta]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", "\[Epsilon]", "*", "\[Eta]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4", "\[Eta]"}], "-", 
       RowBox[{"4", 
        RowBox[{"\[Eta]", "^", "2"}]}], "-", 
       RowBox[{"4", "\[Epsilon]", "*", "\[Eta]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "N6i", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N6j", "=", 
   RowBox[{"Transpose", "[", "N6i", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N3i", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", "-", "\[Epsilon]", "-", "\[Eta]"}], "}"}], ",", 
     RowBox[{"{", "\[Epsilon]", "}"}], ",", 
     RowBox[{"{", "\[Eta]", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "N3i", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N3j", "=", 
    RowBox[{"Transpose", "[", "N3i", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN6jde", "=", 
   RowBox[{"D", "[", 
    RowBox[{"N6j", ",", "\[Epsilon]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN6jdn", "=", 
   RowBox[{"D", "[", 
    RowBox[{"N6j", ",", "\[Eta]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN6jdx", "=", 
   RowBox[{
    RowBox[{"b11", "*", "dN6jde"}], "+", 
    RowBox[{"b12", "*", "dN6jdn"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN6jdy", "=", 
   RowBox[{
    RowBox[{"b21", "*", "dN6jde"}], "+", 
    RowBox[{"b22", "*", "dN6jdn"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN6idx", "=", 
   RowBox[{"Transpose", "[", "dN6jdx", "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"dN6idy", "=", 
    RowBox[{"Transpose", "[", "dN6jdy", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN3jde", "=", 
   RowBox[{"D", "[", 
    RowBox[{"N3j", ",", "\[Epsilon]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN3jdn", "=", 
   RowBox[{"D", "[", 
    RowBox[{"N3j", ",", "\[Eta]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN3jdx", "=", 
   RowBox[{
    RowBox[{"b11", "*", "dN3jde"}], "+", 
    RowBox[{"b12", "*", "dN3jdn"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN3jdy", "=", 
   RowBox[{
    RowBox[{"b21", "*", "dN3jde"}], "+", 
    RowBox[{"b22", "*", "dN3jdn"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dN3idx", "=", 
   RowBox[{"Transpose", "[", "dN3jdx", "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"dN3idy", "=", 
    RowBox[{"Transpose", "[", "dN3jdy", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S3j", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"s31", ",", "s32", ",", "s33"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S3i", "=", 
   RowBox[{"Transpose", "[", "S3j", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S6j", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"s61", ",", "s62", ",", "s63", ",", 
      RowBox[{"0.5", "*", 
       RowBox[{"(", 
        RowBox[{"s61", "+", "s62"}], ")"}]}], ",", 
      RowBox[{"0.5", "*", 
       RowBox[{"(", 
        RowBox[{"s62", "+", "s63"}], ")"}]}], ",", 
      RowBox[{"0.5", "*", 
       RowBox[{"(", 
        RowBox[{"s63", "+", "s61"}], ")"}]}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S6i", "=", 
    RowBox[{"Transpose", "[", "S6j", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Trying", " ", "to", " ", "check", " ", "that", " ", "if", " ", "the", 
     " ", "middle", " ", "node", " ", "values", " ", "are", " ", 
     "\[IndentingNewLine]", "  ", "half", " ", "of", " ", "vertex", " ", 
     "values"}], ",", " ", 
    RowBox[{
    "then", " ", "interpolation", " ", "within", " ", "the", " ", "triangle", 
     "\[IndentingNewLine]", "  ", "using", " ", "3", " ", "points", " ", 
     "should", " ", "be", " ", "same", " ", "as", " ", "that", " ", "using", 
     " ", "6", " ", "points"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"S", "=", 
  RowBox[{"N3j", ".", "S3i"}]}], "\[IndentingNewLine]", 
 RowBox[{"S", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"N6j", ".", "S6i"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7786684318250513`*^9, 3.778668693667934*^9}, {
  3.778668875188271*^9, 
  3.778668934140441*^9}},ExpressionUUID->"9b474aff-9939-480f-84b6-\
2c3f9407ec5b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       RowBox[{"3", " ", "\[Epsilon]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}], "-", 
       RowBox[{"3", " ", "\[Eta]"}], "+", 
       RowBox[{"4", " ", "\[Epsilon]", " ", "\[Eta]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Eta]", "2"]}]}]},
     {
      RowBox[{
       RowBox[{"-", "\[Epsilon]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}]}]},
     {
      RowBox[{
       RowBox[{"-", "\[Eta]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Eta]", "2"]}]}]},
     {
      RowBox[{
       RowBox[{"4", " ", "\[Epsilon]"}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}], "-", 
       RowBox[{"4", " ", "\[Epsilon]", " ", "\[Eta]"}]}]},
     {
      RowBox[{"4", " ", "\[Epsilon]", " ", "\[Eta]"}]},
     {
      RowBox[{
       RowBox[{"4", " ", "\[Eta]"}], "-", 
       RowBox[{"4", " ", "\[Epsilon]", " ", "\[Eta]"}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[Eta]", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.778668465880474*^9, 3.778668491836481*^9}, 
   3.7786686610935783`*^9, 3.778668695145154*^9},
 CellLabel->
  "Out[85]//MatrixForm=",ExpressionUUID->"d6bd2048-01c5-4bc6-ab27-\
9be2a8d995ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", "\[Epsilon]", "-", "\[Eta]"}]},
     {"\[Epsilon]"},
     {"\[Eta]"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.778668465880474*^9, 3.778668491836481*^9}, 
   3.7786686610935783`*^9, 3.778668695148333*^9},
 CellLabel->
  "Out[88]//MatrixForm=",ExpressionUUID->"f1a96b63-dab6-4f5c-b245-\
f28d6a0bac94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"s32", " ", "\[Epsilon]"}], "+", 
    RowBox[{"s31", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Epsilon]", "-", "\[Eta]"}], ")"}]}], "+", 
    RowBox[{"s33", " ", "\[Eta]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.778668465880474*^9, 3.778668491836481*^9}, 
   3.7786686610935783`*^9, 3.7786686951508913`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"227fab55-d848-481f-b2b2-f46eccb459f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"1.`", " ", "s62", " ", "\[Epsilon]"}], "+", 
    RowBox[{"s61", " ", 
     RowBox[{"(", 
      RowBox[{"1.`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.`", " ", "\[Epsilon]"}], "-", 
       RowBox[{"1.`", " ", "\[Eta]"}]}], ")"}]}], "+", 
    RowBox[{"1.`", " ", "s63", " ", "\[Eta]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.778668465880474*^9, 3.778668491836481*^9}, 
   3.7786686610935783`*^9, 3.7786686952198057`*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"9fb63e9a-155b-4d6c-a530-5536c62b598c"]
}, Open  ]]
},
WindowSize->{928, 1028},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5570, 160, 814, "Input",ExpressionUUID->"9b474aff-9939-480f-84b6-2c3f9407ec5b"],
Cell[6153, 184, 1724, 51, 157, "Output",ExpressionUUID->"d6bd2048-01c5-4bc6-ab27-9be2a8d995ce"],
Cell[7880, 237, 761, 22, 83, "Output",ExpressionUUID->"f1a96b63-dab6-4f5c-b245-f28d6a0bac94"],
Cell[8644, 261, 480, 12, 35, "Output",ExpressionUUID->"227fab55-d848-481f-b2b2-f46eccb459f6"],
Cell[9127, 275, 618, 14, 35, "Output",ExpressionUUID->"9fb63e9a-155b-4d6c-a530-5536c62b598c"]
}, Open  ]]
}
]
*)

